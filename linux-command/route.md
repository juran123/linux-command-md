## route ##

显示并设置Linux中静态路由表

### 补充说明 ###

**route命令** 用来显示并设置Linux内核中的网络路由表，route命令设置的路由主要是静态路由。要实现两个不同的子网之间的通信，需要一台连接两个网络的路由器，或者同时位于两个网络的网关来实现。

在Linux系统中设置路由通常是为了解决以下问题：该Linux系统在一个局域网中，局域网中有一个网关，能够让机器访问Internet，那么就需要将这台机器的ip地址设置为Linux机器的默认路由。要注意的是，直接在命令行下执行route命令来添加路由，不会永久保存，当网卡重启或者机器重启之后，该路由就失效了；可以在`/etc/rc.local`中添加route命令来保证该路由设置永久有效。

###  语法

	route(选项)(参数)

###  选项

	-A：设置地址类型；
	-C：打印将Linux核心的路由缓存；
	-v：详细信息模式；
	-n：不执行DNS反向查找，直接显示数字形式的IP地址；
	-e：netstat格式显示路由表；
	-net：到一个网络的路由表；
	-host：到一个主机的路由表。


###  参数


	Add：增加指定的路由记录；
	Del：删除指定的路由记录；
	Target：目的网络或目的主机；
	gw：设置默认网关；
	mss：设置TCP的最大区块长度（MSS），单位MB；
	window：指定通过路由表的TCP连接的TCP窗口大小；
	dev：路由记录所表示的网络接口。





###  实例

### 1.	显示内存使用情况


	free -t    # 以总和的形式显示内存的使用信息
	free -s 10 # 周期性的查询内存使用信息，每10s 执行一次命令


### 2. **显示当前路由：** 


	[root@localhost ~]# route
	Kernel IP routing table
	Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
	112.124.12.0    *               255.255.252.0   U     0      0        0 eth1
	10.160.0.0      *               255.255.240.0   U     0      0        0 eth0
	192.168.0.0     10.160.15.247   255.255.0.0     UG    0      0        0 eth0
	172.16.0.0      10.160.15.247   255.240.0.0     UG    0      0        0 eth0
	10.0.0.0        10.160.15.247   255.0.0.0       UG    0      0        0 eth0
	default         112.124.15.247  0.0.0.0         UG    0      0        0 eth1
	
	[root@localhost ~]# route -n
	Kernel IP routing table
	Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
	112.124.12.0    0.0.0.0         255.255.252.0   U     0      0        0 eth1
	10.160.0.0      0.0.0.0         255.255.240.0   U     0      0        0 eth0
	192.168.0.0     10.160.15.247   255.255.0.0     UG    0      0        0 eth0
	172.16.0.0      10.160.15.247   255.240.0.0     UG    0      0        0 eth0
	10.0.0.0        10.160.15.247   255.0.0.0       UG    0      0        0 eth0
	0.0.0.0         112.124.15.247  0.0.0.0         UG    0      0        0 eth1


其中Flags为路由标志，标记当前网络节点的状态，Flags标志说明：

*   U Up表示此路由当前为启动状态。
*   H Host，表示此网关为一主机。
*   G Gateway，表示此网关为一路由器。
*   R Reinstate Route，使用动态路由重新初始化的路由。
*   D Dynamically,此路由是动态性地写入。
*   M Modified，此路由是由路由守护程序或导向器动态修改。
*   ! 表示此路由当前为关闭状态。

### 3. **添加网关/设置网关：** 


	# route add -net 224.0.0.0 netmask 240.0.0.0 dev eth0    #增加一条到达244.0.0.0的路由。

### 4. **屏蔽一条路由：** 

	# route add -net 224.0.0.0 netmask 240.0.0.0 reject     #增加一条屏蔽的路由，目的地址为224.x.x.x将被拒绝。

### 5. **删除路由记录：** 


	#route del -net 224.0.0.0 netmask 240.0.0.0
	#route del -net 224.0.0.0 netmask 240.0.0.0 reject

### 6. **删除和添加设置默认网关：** 

	#route del default gw 192.168.120.240
	#route add default gw 192.168.120.240

### 7.	显示以IP格式显示路由表的全部内容。执行命令：
	#	route -n
	内核 IP 路由表
	目标            网关            子网掩码        标志  跃点   引用  使用 接口
	0.0.0.0         192.168.1.1     0.0.0.0         UG    0      0        0 eth0
	169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 eth0
	192.168.1.0     0.0.0.0         255.255.255.0   U     1      0        0 eth0

### 8.在路由表中添加一个到指定网络的静态路由。
		在为路由表添加路由之前，首先执行命令显示路由表的信息：
	#	ifconfig
		接下来为路由表添加一个到网络192.168.1.0的静态路由，其中子网掩码为255.255.255.0，
        网关为192.168.1.1，设备接口为eth0 ：
	#	route add –net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1 dev eth0
		静态路由添加完毕后，再次显示路由表的信息，然后对两次路由表信息进行比较研究。

### 9. 从路由表中删除静态路由。
	#	route del –net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1 dev eth0

### 10. 在当前路由表中增加一条规则，拒绝数据包路由到私有网络10.0.0.0，子网掩码为255.0.0.0。执行命令：
	#	route add 192.168.2.0 mask 255.255.255.0 192.168.1.100

### 11.	设置访问外网的缺省网关为192.168.1.1
	#	route add default gw 192.168.1.1 eth0

### 12.	为两个目标网络（一个是Internet网络，另一个是私有网络10.0.0.0）设置两个网关，其中连接Internet网络的网关地址为192.168.1.1，连接私有网络的网关地址为192.168.1.254。执行命令：
	#	route add default gw 192.168.1.1 eth0 
	#	route add –net 10.0.0.0 netmask 255.0.0.0 gw 192.168.1.254 eth0
